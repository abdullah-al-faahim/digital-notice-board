<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCR Digital - Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tiro+Bangla:wght@400&display=swap" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/seven-segment" rel="stylesheet">
    <style>
        body {
            font-family: 'Tiro Bangla', 'Inter', sans-serif;
        }

        #login-section {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notice-card {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }

        .notice-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        #clock {
            font-family: 'Seven Segment', sans-serif;
            font-size: 3rem;
            /* Adjust as needed */
            font-weight: bold;
            color: #0F0;
            /* Bright green for digital display */
            text-shadow: 0 0 8px rgba(0, 255, 0, 0.6);
            /* Subtle glow */
        }

        /* Modal styles */
        .modal {
            display: none;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1000;
            /* Sit on top */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            /* Could be more or less, depending on screen size */
            max-width: 500px;
            border-radius: 0.5rem;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <div class="absolute top-4 right-4 z-20">
        <button id="lang-switcher" class="bg-indigo-600 text-white font-semibold px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition">বাংলা</button>
    </div>

    <!-- Login Section -->
    <div id="login-section">
        <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-sm">
            <img src="./Channel-i.svg" alt="Channel i Logo" class="mx-auto mb-6" style="max-height: 80px;">
            <h1 class="text-2xl font-bold text-center text-gray-900 mb-6" data-lang="login_title">MCR Digital Login</h1>
            <form id="login-form">
                <div class="mb-4">
                    <label for="username" class="block text-sm font-medium text-gray-700 mb-1" data-lang="username_label">Username</label>
                    <input type="text" id="username" name="username" required
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                </div>
                <div class="mb-6">
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-1" data-lang="password_label">Password</label>
                    <input type="password" id="password" name="password" required
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                </div>
                <button type="submit"
                    class="w-full bg-indigo-600 text-white font-semibold px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition" data-lang="login_button">
                    Login
                </button>
                <p id="login-error" class="text-red-500 text-sm mt-4 text-center" style="display: none;" data-lang="login_error">Invalid
                    username or
                    password.</p>
            </form>
        </div>
    </div>

    <!-- Notice Board Section (hidden by default) -->
    <div id="notice-board-section" class="container mx-auto p-4 md:p-8 max-w-4xl" style="display: none;">

        <!-- Header -->
        <header class="text-center mb-8">
            <!-- Channel i Logo -->
            <img src="./Channel-i.svg" alt="Channel i Logo" class="mx-auto mb-4" style="max-height: 80px;">
            <h1 class="text-4xl font-bold text-gray-900" data-lang="notice_board_title">MCR ডিজিটাল নোটিশ বোর্ড</h1>
            <p class="text-gray-600 mt-2" data-lang="notice_board_subtitle">Live updates for programs and schedules.</p>
            <!-- Digital Clock -->
            <div id="clock-container" class="mt-4 inline-block px-4 pt-4 pb-2 rounded-lg"
                style="background-color: #333;">
                <p class="text-lg font-semibold text-gray-800">
                    <span id="clock" class="text-indigo-600"></span>
                </p>
            </div>
        </header>

        <!-- Add New Notice Form -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
            <h2 class="text-2xl font-semibold mb-4" data-lang="add_new_update">Add a New Update</h2>
            <form id="add-notice-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="program-name" class="block text-sm font-medium text-gray-700 mb-1" data-lang="program_name_label">Program
                            Name</label>
                        <input type="text" id="program-name" name="program-name"
                            data-lang-placeholder="program_name_placeholder" placeholder="e.g., Promo / Title / Program" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                    </div>
                    <div>
                        <label for="duration" class="block text-sm font-medium text-gray-700 mb-1" data-lang="duration_label">Duration /
                            Time</label>
                        <input type="text" id="duration" name="duration"
                            data-lang-placeholder="duration_placeholder" placeholder="e.g., 2 min / 5 min/ 20 min / 30 min" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                    </div>
                </div>
                <div class="mt-4">
                    <label for="additional-message" class="block text-sm font-medium text-gray-700 mb-1" data-lang="additional_message_label">Additional
                        Message</label>
                    <textarea id="additional-message" name="additional-message" rows="3"
                        data-lang-placeholder="additional_message_placeholder" placeholder="e.g., Special guest appearance, important announcement, etc."
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"></textarea>
                </div>
                <div class="flex items-center justify-between mt-6">
                    <div class="flex items-center">
                        <input id="important-toggle" type="checkbox"
                            class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                        <label for="important-toggle" class="ml-2 block text-sm text-gray-900" data-lang="mark_as_important">Mark as Important</label>
                    </div>
                    <button type="submit"
                        class="bg-indigo-600 text-white font-semibold px-6 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition" data-lang="post_update_button">
                        Post Update
                    </button>
                </div>
            </form>
        </div>

        <!-- Notices Display -->
        <div>
            <h2 class="text-2xl font-semibold mb-4 text-gray-900" data-lang="current_programs_title">বর্তমান প্রোগ্রাম</h2>
            <div id="notice-board" class="grid grid-cols-1 gap-6">
                <!-- Notices will be dynamically inserted here -->
                <p id="no-notices-message" class="text-gray-500 col-span-full text-center" data-lang="no_notices_message">No notices posted yet. Add
                    one above!
                </p>
            </div>
        </div>

    </div>

    <!-- Edit Notice Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-2xl font-semibold mb-4" data-lang="edit_update_title">Edit Update</h2>
            <form id="edit-notice-form">
                <input type="hidden" id="edit-notice-id">
                <div class="grid grid-cols-1 gap-4">
                    <div>
                        <label for="edit-program-name" class="block text-sm font-medium text-gray-700 mb-1" data-lang="program_name_label">Program
                            Name</label>
                        <input type="text" id="edit-program-name" name="edit-program-name" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                    </div>
                    <div>
                        <label for="edit-duration" class="block text-sm font-medium text-gray-700 mb-1" data-lang="duration_label">Duration /
                            Time</label>
                        <input type="text" id="edit-duration" name="edit-duration" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                    </div>
                </div>
                <div class="mt-4">
                    <label for="edit-additional-message" class="block text-sm font-medium text-gray-700 mb-1" data-lang="additional_message_label">Additional
                        Message</label>
                    <textarea id="edit-additional-message" name="edit-additional-message" rows="3"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"></textarea>
                </div>
                <div class="flex items-center justify-between mt-6">
                    <div class="flex items-center">
                        <input id="edit-important-toggle" type="checkbox"
                            class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                        <label for="edit-important-toggle" class="ml-2 block text-sm text-gray-900" data-lang="mark_as_important">Mark as
                            Important</label>
                    </div>
                    <div>
                        <button type="button" onclick="closeEditModal()"
                            class="bg-gray-300 text-gray-800 font-semibold px-6 py-2 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition mr-2" data-lang="cancel_button">
                            Cancel
                        </button>
                        <button type="submit"
                            class="bg-indigo-600 text-white font-semibold px-6 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition" data-lang="save_changes_button">
                            Save Changes
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        // --- Login Functionality ---
        const loginForm = document.getElementById('login-form');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginError = document.getElementById('login-error');
        const loginSection = document.getElementById('login-section');
        const noticeBoardSection = document.getElementById('notice-board-section');

        // Static credentials
        const STATIC_USERNAME = 'admin';
        const STATIC_PASSWORD = 'mcr123';

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();

            if (username === STATIC_USERNAME && password === STATIC_PASSWORD) {
                // Hide login and show notice board
                loginSection.style.display = 'none';
                noticeBoardSection.style.display = 'block';
                // Initialize notice board functionality
                initializeNoticeBoard();
            } else {
                loginError.style.display = 'block';
            }
        });


        // --- Clock Functionality ---

        const clockElement = document.getElementById('clock');

        function updateClock() {
            const now = new Date();
            const options = {
                timeZone: 'Asia/Dhaka', // Bangladesh Standard Time
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true // Revert to true for 12-hour format
            };
            let timeString = now.toLocaleTimeString('en-US', options);
            timeString = timeString.replace(/\s[AP]M$/, ''); // Remove AM/PM
            clockElement.textContent = timeString;
        }

        function initializeNoticeBoard() {
            // Update the clock immediately and then every second
            updateClock();
            setInterval(updateClock, 1000);

            // --- Notice Board Functionality ---
            const noticeForm = document.getElementById('add-notice-form');
            const programNameInput = document.getElementById('program-name');
            const durationInput = document.getElementById('duration');
            const additionalMessageInput = document.getElementById('additional-message');
            const importantToggle = document.getElementById('important-toggle');
            const noticeBoard = document.getElementById('notice-board');
            const noNoticesMessage = document.getElementById('no-notices-message');

            const editModal = document.getElementById('edit-modal');
            const editNoticeForm = document.getElementById('edit-notice-form');
            const editNoticeIdInput = document.getElementById('edit-notice-id');
            const editProgramNameInput = document.getElementById('edit-program-name');
            const editDurationInput = document.getElementById('edit-duration');
            const editAdditionalMessageInput = document.getElementById('edit-additional-message');
            const editImportantToggle = document.getElementById('edit-important-toggle');

            // Load notices from local storage or initialize an empty array
            let notices = JSON.parse(localStorage.getItem('digitalNotices')) || [];

            // Function to format date for timeline
            const formatDateForTimeline = (date) => {
                const options = { day: 'numeric', month: 'short' };
                return date.toLocaleDateString('en-US', options);
            };

            const renderNotices = () => {
                // Clear the board first
                noticeBoard.innerHTML = '';

                if (notices.length === 0) {
                    if (!document.getElementById('no-notices-message')) {
                        noticeBoard.innerHTML = `<p id="no-notices-message" class="text-gray-500 col-span-full text-center" data-lang="no_notices_message">${translations[currentLang].no_notices_message}</p>`;
                    }
                    return;
                }

                const existingMessage = document.getElementById('no-notices-message');
                if (existingMessage) existingMessage.remove();

                // Sort notices to show the newest first
                const sortedNotices = [...notices].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

                // Group notices by date
                const groupedNotices = sortedNotices.reduce((acc, notice) => {
                    const noticeDate = new Date(notice.timestamp).toDateString();
                    if (!acc[noticeDate]) {
                        acc[noticeDate] = [];
                    }
                    acc[noticeDate].push(notice);
                    return acc;
                }, {});

                // Create timeline view
                for (const dateStr in groupedNotices) {
                    const timelineDate = new Date(dateStr);
                    const formattedTimelineDate = formatDateForTimeline(timelineDate);

                    const dateHeader = document.createElement('div');
                    dateHeader.className = 'flex items-center my-4';
                    dateHeader.innerHTML = `
                        <div class="w-20 text-right pr-4">
                            <p class="text-lg font-semibold text-gray-700">${formattedTimelineDate}</p>
                        </div>
                        <div class="flex-grow border-t border-gray-300"></div>
                    `;
                    noticeBoard.appendChild(dateHeader);

                    const noticesForDate = groupedNotices[dateStr];
                    noticesForDate.forEach(notice => {
                        const noticeElement = document.createElement('div');
                        noticeElement.className = 'notice-card bg-white p-5 rounded-lg border border-gray-200 flex flex-col ml-24 mb-4'; // Indent notices

                        const formattedTime = new Date(notice.timestamp).toLocaleTimeString('en-US', {
                            timeStyle: 'short'
                        });

                        noticeElement.innerHTML = `
                            <div class="flex-grow">
                                <h3 class="text-xl font-bold text-indigo-700 mb-2">${notice.important ? '&#9733; ' : ''}${notice.program}</h3>
                                <p class="text-gray-700"><span class="font-semibold">${translations[currentLang].duration}:</span> ${notice.duration}</p>
                                ${notice.message ? `<p class="text-gray-600 mt-2"><strong>${translations[currentLang].message}:</strong> ${notice.message}</p>` : ''}
                            </div>
                            <div class="mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500 flex justify-between items-center">
                                <span>${translations[currentLang].posted_at} ${formattedTime}</span>
                                <div>
                                    <button onclick="openEditModal('${notice.id}')" class="text-blue-500 hover:text-blue-700 font-semibold focus:outline-none mr-2">${translations[currentLang].edit}</button>
                                    <button onclick="deleteNotice('${notice.id}')" class="text-red-500 hover:text-red-700 font-semibold focus:outline-none">${translations[currentLang].delete}</button>
                                </div>
                            </div>
                        `;
                        noticeBoard.appendChild(noticeElement);
                    });
                }
            };

            // Function to save notices to local storage
            const saveNotices = () => {
                localStorage.setItem('digitalNotices', JSON.stringify(notices));
            };

            // Function to add a new notice
            const addNotice = (program, duration, message, important) => {
                const newNotice = {
                    id: 'notice-' + Date.now(), // Unique ID for each notice
                    program,
                    duration,
                    message,
                    important,
                    timestamp: new Date().toISOString()
                };
                notices.push(newNotice);
                saveNotices();
                renderNotices();
            };

            // Function to delete a notice
            window.deleteNotice = (id) => {
                notices = notices.filter(notice => notice.id !== id);
                saveNotices();
                renderNotices();
            };

            // Function to open the edit modal
            window.openEditModal = (id) => {
                const noticeToEdit = notices.find(notice => notice.id === id);
                if (noticeToEdit) {
                    editNoticeIdInput.value = noticeToEdit.id;
                    editProgramNameInput.value = noticeToEdit.program;
                    editDurationInput.value = noticeToEdit.duration;
                    editAdditionalMessageInput.value = noticeToEdit.message;
                    editImportantToggle.checked = noticeToEdit.important || false;
                    editModal.style.display = 'block';
                }
            };

            // Function to close the edit modal
            window.closeEditModal = () => {
                editModal.style.display = 'none';
            };

            // Function to update a notice
            const updateNotice = (id, program, duration, message, important) => {
                const noticeIndex = notices.findIndex(notice => notice.id === id);
                if (noticeIndex > -1) {
                    notices[noticeIndex].program = program;
                    notices[noticeIndex].duration = duration;
                    notices[noticeIndex].message = message;
                    notices[noticeIndex].important = important;
                    saveNotices();
                    renderNotices();
                    closeEditModal();
                }
            };

            // Event listener for add form submission
            noticeForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const programName = programNameInput.value.trim();
                const duration = durationInput.value.trim();
                const additionalMessage = additionalMessageInput.value.trim();
                const important = importantToggle.checked;

                if (programName && duration) {
                    addNotice(programName, duration, additionalMessage, important);
                    noticeForm.reset();
                    programNameInput.focus();
                }
            });

            // Event listener for edit form submission
            editNoticeForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const id = editNoticeIdInput.value;
                const programName = editProgramNameInput.value.trim();
                const duration = editDurationInput.value.trim();
                const additionalMessage = editAdditionalMessageInput.value.trim();
                const important = editImportantToggle.checked;

                if (id && programName && duration) {
                    updateNotice(id, programName, duration, additionalMessage, important);
                }
            });

            // Close modal if user clicks outside of it
            window.onclick = function (event) {
                if (event.target == editModal) {
                    closeEditModal();
                }
            }

            // Initial render on page load
            renderNotices();
        }

        // --- Language Switcher Functionality ---
        const translations = {
            en: {
                login_title: 'MCR Digital Login',
                username_label: 'Username',
                password_label: 'Password',
                login_button: 'Login',
                login_error: 'Invalid username or password.',
                notice_board_title: 'MCR Digital Notice Board',
                notice_board_subtitle: 'Live updates for programs and schedules.',
                add_new_update: 'Add a New Update',
                program_name_label: 'Program Name',
                program_name_placeholder: 'e.g., Promo / Title / Program',
                duration_label: 'Duration / Time',
                duration_placeholder: 'e.g., 2 min / 5 min/ 20 min / 30 min',
                additional_message_label: 'Additional Message',
                additional_message_placeholder: 'e.g., Special guest appearance, important announcement, etc.',
                mark_as_important: 'Mark as Important',
                post_update_button: 'Post Update',
                current_programs_title: 'Current Programs',
                no_notices_message: 'No notices posted yet. Add one above!',
                edit_update_title: 'Edit Update',
                cancel_button: 'Cancel',
                save_changes_button: 'Save Changes',
                // Dynamic content
                duration: 'Duration',
                message: 'Message',
                posted_at: 'Posted at',
                edit: 'Edit',
                delete: 'Delete',
            },
            bn: {
                login_title: 'এমসিআর ডিজিটাল লগইন',
                username_label: 'ব্যবহারকারীর নাম',
                password_label: 'পাসওয়ার্ড',
                login_button: 'লগইন',
                login_error: 'অবৈধ ব্যবহারকারীর নাম বা পাসওয়ার্ড।',
                notice_board_title: 'এমসিআর ডিজিটাল নোটিশ বোর্ড',
                notice_board_subtitle: 'প্রোগ্রাম এবং সময়সূচীর জন্য লাইভ আপডেট।',
                add_new_update: 'একটি নতুন আপডেট যোগ করুন',
                program_name_label: 'প্রোগ্রামের নাম',
                program_name_placeholder: 'যেমন, প্রচার / শিরোনাম / প্রোগ্রাম',
                duration_label: 'সময়কাল / সময়',
                duration_placeholder: 'যেমন, ২ মিনিট / ৫ মিনিট / ২০ মিনিট / ৩০ মিনিট',
                additional_message_label: 'অতিরিক্ত বার্তা',
                additional_message_placeholder: 'যেমন, বিশেষ অতিথি উপস্থিতি, গুরুত্বপূর্ণ ঘোষণা, ইত্যাদি।',
                mark_as_important: 'গুরুত্বপূর্ণ হিসেবে চিহ্নিত করুন',
                post_update_button: 'আপডেট পোস্ট করুন',
                current_programs_title: 'বর্তমান প্রোগ্রাম',
                no_notices_message: 'এখনও কোন নোটিশ পোস্ট করা হয়নি। উপরে একটি যোগ করুন!',
                edit_update_title: 'আপডেট সম্পাদনা করুন',
                cancel_button: 'বাতিল করুন',
                save_changes_button: 'পরিবর্তন সংরক্ষণ করুন',
                // Dynamic content
                duration: 'সময়কাল',
                message: 'বার্তা',
                posted_at: 'পোস্ট করা হয়েছে',
                edit: 'সম্পাদনা',
                delete: 'মুছে ফেলুন',
            }
        };

        const langSwitcher = document.getElementById('lang-switcher');
        let currentLang = localStorage.getItem('language') || 'bn';

        const setLanguage = (lang) => {
            document.querySelectorAll('[data-lang]').forEach(el => {
                const key = el.getAttribute('data-lang');
                if (translations[lang] && translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
            document.querySelectorAll('[data-lang-placeholder]').forEach(el => {
                const key = el.getAttribute('data-lang-placeholder');
                if (translations[lang] && translations[lang][key]) {
                    el.placeholder = translations[lang][key];
                }
            });
            localStorage.setItem('language', lang);
            currentLang = lang;
            langSwitcher.textContent = lang === 'en' ? 'বাংলা' : 'English';
            renderNotices(); // Re-render notices to apply language changes
        };

        langSwitcher.addEventListener('click', () => {
            const newLang = currentLang === 'en' ? 'bn' : 'en';
            setLanguage(newLang);
        });

        // Set initial language
        setLanguage(currentLang);

        
    </script>

</body>

</html>